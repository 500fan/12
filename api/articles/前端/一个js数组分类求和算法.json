{"title":"一个js数组分类求和算法","slug":"前端/一个js数组分类求和算法","date":"2020-02-28T06:30:00.000Z","updated":"2020-11-23T14:37:57.000Z","comments":true,"path":"api/articles/前端/一个js数组分类求和算法.json","realPath":null,"excerpt":null,"covers":["https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E5%85%B1%E7%94%A8/20200228_152031js%E5%88%86%E7%B1%BB%E6%B1%82%E5%92%8C%E7%AE%97%E6%B3%95.png"],"cover":"https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E5%85%B1%E7%94%A8/20200228_152031js%E5%88%86%E7%B1%BB%E6%B1%82%E5%92%8C%E7%AE%97%E6%B3%95.png","content":"<p>需求详情：一个数组内有N个元素，元素有类型、名称、数量1、数量2等属性，计算出各类型元素的数量、数量1、数量2的和。</p>\n<p>实际需求就是做出下图这样一个表格，各类型的合计信息用红色字体显示：</p>\n<p><img src=\"https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E5%85%B1%E7%94%A8/20200228_152031js%E5%88%86%E7%B1%BB%E6%B1%82%E5%92%8C%E7%AE%97%E6%B3%95.png\"></p>\n<p>原始数据格式如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> rawData = [</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">11</span>, <span class=\"attr\">count2</span>: <span class=\"number\">25</span>, <span class=\"attr\">count3</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">11</span>, <span class=\"attr\">count2</span>: <span class=\"number\">25</span>, <span class=\"attr\">count3</span>: <span class=\"number\">35</span> &#125;</span><br><span class=\"line\">    ]</span><br></pre></td></tr></table></figure>\n<p>算法思路：遍历该数组，按类型生成一个二维数组，再遍历该二级数组及其子元素，每遍历完一个类型的子元素后求和，并创建一个新的元素存储该类型元素的和，最后生成一个包含各类型元素数量的新数组，实现代码如下:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">calcSum</span>(<span class=\"params\">arr</span>)</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> newArr = [];</span><br><span class=\"line\">      arr.forEach(<span class=\"function\">(<span class=\"params\">item, index</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        newArr.forEach(<span class=\"function\">(<span class=\"params\">newItem, j</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (newArr[j][<span class=\"number\">0</span>].type === arr[index].type) &#123;</span><br><span class=\"line\">            flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">            k = j;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">          newArr[k].push(arr[index])</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> tempArr = [];</span><br><span class=\"line\">          tempArr.push(arr[index]);</span><br><span class=\"line\">          newArr.push(tempArr);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">const</span> result = []</span><br><span class=\"line\">      newArr.forEach(<span class=\"function\"><span class=\"params\">subArr</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_name = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count1 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count3 = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        subArr.forEach(<span class=\"function\"><span class=\"params\">subItem</span> =&gt;</span> &#123;</span><br><span class=\"line\">          sum_name += <span class=\"number\">1</span>;</span><br><span class=\"line\">          sum_count1 += subItem.count1;</span><br><span class=\"line\">          sum_count2 += subItem.count2;</span><br><span class=\"line\">          sum_count3 += subItem.count3;</span><br><span class=\"line\">          result.push(subItem);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        result.push(&#123;</span><br><span class=\"line\">          type: subArr[<span class=\"number\">0</span>].type,</span><br><span class=\"line\">           name: sum_name,</span><br><span class=\"line\">           count1: sum_count1,</span><br><span class=\"line\">           count2: sum_count2,</span><br><span class=\"line\">           count3: sum_count3,</span><br><span class=\"line\">           isSumRow: <span class=\"literal\">true</span> <span class=\"comment\">//该属性标记为求和行</span></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>生产的二维数组格式如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">newArr = [</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;</span><br><span class=\"line\">       ],</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;</span><br><span class=\"line\">       ],</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;</span><br><span class=\"line\">       ]</span><br><span class=\"line\">     ]</span><br></pre></td></tr></table></figure>\n<p>最终数据格式如下,为了与普通的数据区分开，给求和的数据加上了一个isSumRow属性，用来生成一个className来标红：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = [</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">3</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">39</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">72</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">102</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">3</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">36</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">69</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">99</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">2</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">22</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">50</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">70</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;</span><br><span class=\"line\">         ]</span><br></pre></td></tr></table></figure>","more":"<p>需求详情：一个数组内有N个元素，元素有类型、名称、数量1、数量2等属性，计算出各类型元素的数量、数量1、数量2的和。</p>\n<p>实际需求就是做出下图这样一个表格，各类型的合计信息用红色字体显示：</p>\n<p><img src=\"https://images.liyangzone.com/article_img/%E6%8A%80%E6%9C%AF%E7%9B%B8%E5%85%B3/%E5%85%B1%E7%94%A8/20200228_152031js%E5%88%86%E7%B1%BB%E6%B1%82%E5%92%8C%E7%AE%97%E6%B3%95.png\"></p>\n<p>原始数据格式如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">const</span> rawData = [</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">13</span>, <span class=\"attr\">count2</span>: <span class=\"number\">24</span>, <span class=\"attr\">count3</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">12</span>, <span class=\"attr\">count2</span>: <span class=\"number\">23</span>, <span class=\"attr\">count3</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">11</span>, <span class=\"attr\">count2</span>: <span class=\"number\">25</span>, <span class=\"attr\">count3</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">      &#123; <span class=\"attr\">type</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"attr\">name</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"attr\">count1</span>: <span class=\"number\">11</span>, <span class=\"attr\">count2</span>: <span class=\"number\">25</span>, <span class=\"attr\">count3</span>: <span class=\"number\">35</span> &#125;</span><br><span class=\"line\">    ]</span><br></pre></td></tr></table></figure>\n<p>算法思路：遍历该数组，按类型生成一个二维数组，再遍历该二级数组及其子元素，每遍历完一个类型的子元素后求和，并创建一个新的元素存储该类型元素的和，最后生成一个包含各类型元素数量的新数组，实现代码如下:</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"title\">calcSum</span>(<span class=\"params\">arr</span>)</span> &#123;</span><br><span class=\"line\">      <span class=\"keyword\">const</span> newArr = [];</span><br><span class=\"line\">      arr.forEach(<span class=\"function\">(<span class=\"params\">item, index</span>) =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> flag = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> k = <span class=\"number\">0</span>;</span><br><span class=\"line\">        newArr.forEach(<span class=\"function\">(<span class=\"params\">newItem, j</span>) =&gt;</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">if</span> (newArr[j][<span class=\"number\">0</span>].type === arr[index].type) &#123;</span><br><span class=\"line\">            flag = <span class=\"number\">1</span>;</span><br><span class=\"line\">            k = j;</span><br><span class=\"line\">          &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">          newArr[k].push(arr[index])</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">          <span class=\"keyword\">const</span> tempArr = [];</span><br><span class=\"line\">          tempArr.push(arr[index]);</span><br><span class=\"line\">          newArr.push(tempArr);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">      <span class=\"keyword\">const</span> result = []</span><br><span class=\"line\">      newArr.forEach(<span class=\"function\"><span class=\"params\">subArr</span> =&gt;</span> &#123;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_name = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count1 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count2 = <span class=\"number\">0</span>;</span><br><span class=\"line\">        <span class=\"keyword\">let</span> sum_count3 = <span class=\"number\">0</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">        subArr.forEach(<span class=\"function\"><span class=\"params\">subItem</span> =&gt;</span> &#123;</span><br><span class=\"line\">          sum_name += <span class=\"number\">1</span>;</span><br><span class=\"line\">          sum_count1 += subItem.count1;</span><br><span class=\"line\">          sum_count2 += subItem.count2;</span><br><span class=\"line\">          sum_count3 += subItem.count3;</span><br><span class=\"line\">          result.push(subItem);</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">        result.push(&#123;</span><br><span class=\"line\">          type: subArr[<span class=\"number\">0</span>].type,</span><br><span class=\"line\">           name: sum_name,</span><br><span class=\"line\">           count1: sum_count1,</span><br><span class=\"line\">           count2: sum_count2,</span><br><span class=\"line\">           count3: sum_count3,</span><br><span class=\"line\">           isSumRow: <span class=\"literal\">true</span> <span class=\"comment\">//该属性标记为求和行</span></span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;)</span><br><span class=\"line\">      <span class=\"keyword\">return</span> result;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>生产的二维数组格式如下：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">newArr = [</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;</span><br><span class=\"line\">       ],</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;</span><br><span class=\"line\">       ],</span><br><span class=\"line\">       [</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">         &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;</span><br><span class=\"line\">       ]</span><br><span class=\"line\">     ]</span><br></pre></td></tr></table></figure>\n<p>最终数据格式如下,为了与普通的数据区分开，给求和的数据加上了一个isSumRow属性，用来生成一个className来标红：</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">result = [</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称1&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称2&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称3&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">13</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">24</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">34</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型A&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">3</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">39</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">72</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">102</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称4&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称5&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称6&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">12</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">23</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">33</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型B&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">3</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">36</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">69</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">99</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称7&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"string\">&#x27;名称8&#x27;</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">11</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">25</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">35</span> &#125;,</span><br><span class=\"line\">           &#123; <span class=\"string\">&#x27;type&#x27;</span>: <span class=\"string\">&#x27;类型C&#x27;</span>, <span class=\"string\">&#x27;name&#x27;</span>: <span class=\"number\">2</span>, <span class=\"string\">&#x27;count1&#x27;</span>: <span class=\"number\">22</span>, <span class=\"string\">&#x27;count2&#x27;</span>: <span class=\"number\">50</span>, <span class=\"string\">&#x27;count3&#x27;</span>: <span class=\"number\">70</span>, <span class=\"string\">&#x27;isSumRow&#x27;</span>: <span class=\"literal\">true</span> &#125;</span><br><span class=\"line\">         ]</span><br></pre></td></tr></table></figure>","categories":[{"name":"技术分享","path":"api/categories/技术分享.json"}],"tags":[{"name":"JavaScript","path":"api/tags/JavaScript.json"},{"name":"算法","path":"api/tags/算法.json"}]}